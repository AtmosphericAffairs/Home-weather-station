# Home weather station / Домашняя метеорологическая станция

## Содержание
- [Цель проекта](#цель-проекта)
- [Описание](#Описание)
- [Принцип работы](#принцип-работы)
- [Функциональность](#функциональность)
    - [Сбор данных](#сбор-данных)
    - [Передача данных](#передача-данных)
    - [Визуализация](#визуализация)
- [Ключевые решения](#ключевые-решения)
    - [Протокол обмена данными](#протокол-обмена-данными)
    - [Алгоритм автоматического подключения](#алгоритм-автоматического-подключения)
    - [Выбор GUI-фреймворка](#выбор-gui-фреймворка)
- [Требования](#требования)
    - [Аппаратная часть (Hardware)](#аппаратная-часть-hardware)
    - [Программная часть (Software)](#программная-часть-software)
- [Описание кода](#описание-кода)
    - [Arduino](#arduino)
    - [Python](#python)
    - [C++](#C)
- [Инструкция по сборке аппаратной части](#инструкция-по-сборке-аппаратной-части)
    - [Пайка](#пайка)
    - [Прошивка Arduino](#прошивка-arduino)
- [Инструкция по использованию ПО на Python](#Инструкция-по-использованию-ПО-на-Python)
- [Инструкция по использованию ПО на C++](#Инструкция-по-использованию-ПО-на-C)
- [Эксплуатация](#эксплуатация)
- [Планы на доработку](#планы-на-доработку)


## Цель проекта

Проект создан в учебных целях для комплексного освоения полного цикла разработки — от прошивки микроконтроллера до создания документации.

**Ключевые учебные задачи:**
*   **Микроконтроллер Arduino:** Освоение работы с периферией, опроса датчиков, обработки данных и организации межплатформенного взаимодействия.
*   **Desktop-приложение на Python:** Изучение построения GUI на PyQt, работы с последовательным портом через PySerial и визуализации данных в реальном времени с помощью Matplotlib.
*   **Desktop-приложение на C++:** Углубление в разработку нативного, кроссплатформенного ПО с использованием фреймворка Qt и современных стандартов C++.
*   **Системное проектирование:** Проектирование протокола обмена данными между устройствами и выбор эффективных форматов сериализации (JSON).
*   **Документирование:** Освоение принципов написания структурированной и понятной технической документации.


## Описание
Устройство предназначено для измерения основных атмосферных характеристик в домашних условиях.

Оно состоит из аппаратной части на базе Arduino и единого сервера сбора данных на ПК. Для кроссплатформенности и сравнения технологий клиентская часть для ПК реализована дважды: на Python и на C++.

## Принцип работы

Микроконтроллер Arduino опрашивает датчики с интервалом в секунду, формирует пакет данных и отправляет на ПК. Приложение на ПК парсит данные, переводит в удобные единицы измерения, определяет экстремумы, строит графики, отображает для пользователя.

## Функциональность

### Сбор данных
- **Давление:** Измерения в диапазоне от 300 гПа до 1100 гПа с точностью до 0,01 гПа
- **Температура:** Измерения в диапазоне от -80°C до 120°C с точностью ± 0,1°C
- **Скорость ветра:** Измерения в диапазоне от 0 м/с до 60 м/с с точностью ± 0,01 м/с

### Передача данных
- **Формат данных:** JSON
- **Способ передачи:** COM-порт

### Визуализация
- Отображение текущих значений в реальном времени
- Отображение экстремумов за 3 часа
- Отображение графиков за 3 часа

## Ключевые решения

### Протокол обмена данными
-   **Проблема:** Необходимость передавать структурированные данные между Arduino и PC.
-   **Решение:** Использование текстового формата JSON.
-   **Обоснование:** Формат прост для чтения и отладки, не привязан к архитектуре, имеет проверенные библиотеки для парсинга на стороне ПК (`nlohmann/json` для C++, встроенный `json` модуль для Python).

### Алгоритм автоматического подключения
-   **Проблема:** Избежание необходимости вручную искать и указывать COM-порт в настройках.
-   **Решение:** Реализация механизма "handshake" при запуске PC-приложения. Приложение поочередно опрашивает доступные порты, отправляя служебный запрос. Устройство, получив его, отвечает заранее оговоренной строкой-идентификатором.
-   **Обоснование:** Обеспечение удобства пользования и предотвращение подключения к неправильному устройству.

### Выбор GUI-фреймворка
-    Qt6 (PyQt6) выбран как один из наиболее мощных и популярных фреймворков для создания desktop-приложений, имеющий богатый набор виджетов и отличную документацию.

## Требования 

### Аппаратная часть
- Arduino Uno
- Датчик давления BMP180
- Датчики температуры DS18B20
- Датчик скорости ветра ABS
- Резистор на 24 кOм
- USB кабель


### Программная часть

- Arduino IDE, библиотеки: ArduinoJson.h, OneWire.h, SFE_BMP180.h
- Для ПО на Python: Интерпритатор Python 3.8, библиотеки: PyQt6, PySerial, MatPlotLib
- Для ПО на С++: Компилятор для C++, CMake, библиотеки: Qt6, boost/asio, boost/filesystem, nlohmann/json

## Описание кода
### Arduino

Код выполняет две основные задачи: обработка команд от компьютера и регулярный опрос датчиков с отправкой данных.
#### Ключевые функции

1. **Автоопределение (Handshake):**

При получении команды WHO_ARE_YOU отвечает строкой "i im meteo".

Это позволяет ПО на ПК автоматически найти и подключиться к устройству среди других COM-портов.

2. **Сбор данных:**

    - **Температура:** Считывается с цифрового датчика DS18B20 по протоколу OneWire.

    - **Давление:** Измеряется с помощью датчика BMP180 по шине I2C.

    - **Аналоговый сигнал:** Читается с пина A1 (предназначен для датчика скорости ветра).

3. **Передача данных:**

Данные упаковываются в JSON-объект и отправляются раз в секунду.

Формат: {"temperature": 24.7, "val": 512, "pressure": 1013.25}

#### Принцип работы

В главном цикле реализуется приоритетная обработка входящих команд. Если команда получена (WHO_ARE_YOU), отправка данных в текущем цикле пропускается для обеспечения мгновенного ответа.

**Используемые библиотеки:**

ArduinoJson – для формирования JSON-сообщений.

OneWire и SFE_BMP180 – для работы с датчиками.

Wire – для работы с шиной I2C.
### Python

### C++

## Инструкция по сборке аппаратной части
### Пайка
### Прошивка Arduino
## Инструкция по использованию ПО на Python
## Инструкция по использованию ПО на C++


## Эксплуатация

## Планы на доработку



